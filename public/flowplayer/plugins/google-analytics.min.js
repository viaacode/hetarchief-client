!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):((e=e||self).flowplayer=e.flowplayer||{},e.flowplayer.google_analytics=t())}(this,(function(){"use strict";function e(e,t,a){if("object"==typeof e.ga){var l,o,r=flowplayer.events,d=flowplayer.AdEvents||{AD_STARTED:"ad-started",AD_COMPLETED:"ad-completed",AD_SKIPPED:"ad-skipped",AD_BREAK_COMPLETED:"ad-break-completed"},i=!1,_=!1,s=a.muted||!1,n=!0,p=!1,c=e.ga.ga_instances||[],u=[],v=[0,0,0],m=e.ga.media_title||"unknown video title",f="preroll";o=e.ga.event_actions?e.ga.event_actions:{fullscreen_enter:"fullscreen_enter",fullscreen_exit:"fullscreen_exit",video_player_load:"video_player_load",video_start:"video_start",video_click_play:"video_click_play",video_pause:"video_pause",video_resume:"video_resume",video_mute:"video_mute",video_unmute:"video_unmute",video_25_percent:"video_25_percent",video_50_percent:"video_50_percent",video_75_percent:"video_75_percent",video_complete:"video_complete",live_start:"live_start",live_click_play:"live_click_play",live_pause:"live_pause",live_resume:"live_resume",live_mute:"live_mute",live_unmute:"live_unmute",live_complete:"live_complete",ad_start_preroll:"ad_start_preroll",ad_start_midroll:"ad_start_midroll",ad_start_postroll:"ad_start_postroll",ad_completed_preroll:"ad_completed_preroll",ad_completed_midroll:"ad_completed_midroll",ad_completed_postroll:"ad_completed_postroll",ad_skipped_preroll:"ad_skipped_preroll",ad_skipped_midroll:"ad_skipped_midroll",ad_skipped_postroll:"ad_skipped_postroll",ad_break_completed:"ad_break_completed"},l=e.ga.event_categories?e.ga.event_categories:{live:"Live",videos:"Videos"},a.on([r.MOUNT,r.TIME_UPDATE,r.LOAD_START,r.ENDED,r.SEEKED,r.SEEKING,r.PAUSE,r.PLAYING,r.VOLUME_CHANGE,d.AD_STARTED,d.AD_COMPLETED,d.AD_SKIPPED,d.AD_BREAK_COMPLETED,r.CONFIG,r.CLICK,r.TOUCHEND,r.FULLSCREEN_ENTER,r.FULLSCREEN_EXIT],(function(t){switch(t.type){case"playing":r=t.type,i?_&&(_=!1,E(p?o.live_resume:o.video_resume)):k(r);break;case"pause":Math.abs(a.duration-a.currentTime)<1||!i||(_=!0,E(p?o.live_pause:o.video_pause));break;case"mount":break;case"timeupdate":p||(a.currentTime/a.duration>.25&&0===v[0]?(v[0]=1,E(o.video_25_percent)):a.currentTime/a.duration>.5&&0===v[1]?(v[1]=1,E(o.video_50_percent)):a.currentTime/a.duration>.75&&0===v[2]&&(v[2]=1,E(o.video_75_percent)));break;case"ended":y();break;case"volumechange":a.muted&&!s?(s=!0,E(p?o.live_mute:o.video_mute)):!a.muted&&s&&(s=!1,E(p?o.live_unmute:o.video_unmute));break;case"ad-started":!function(e){if(e&&e.data&&e.data.ad_type)switch(e.data.ad_type){case"midroll":f="midroll",E(o.ad_start_midroll);break;case"postroll":f="postroll",E(o.ad_start_postroll);break;default:f="preroll",E(o.ad_start_preroll)}else f="preroll",E(o.ad_start_preroll)}(t);break;case"ad-completed":!function(){if(f)switch(f){case"midroll":E(o.ad_completed_midroll);break;case"postroll":E(o.ad_completed_postroll);break;default:E(o.ad_completed_preroll)}else E(o.ad_completed_preroll)}();break;case"ad-break-completed":!function(e){k(e),E(o.ad_break_completed)}(t.type);break;case"config":(l=t).data&&(!0!==l.data.live&&"true"!==l.data.live||(p=!0),l.data.title?m=l.data.title:l.data.metadata&&l.data.metadata.title&&(m=l.data.metadata.title)),e.ga.start_on||(e.ga.start_on="playing"),a.ads||(e.ga.start_on="playing"),n&&(n=!1,E(o.video_player_load));break;case"click":!_&&i||E(p?o.live_click_play:o.video_click_play);break;case"fullscreenenter":E(o.fullscreen_enter);break;case"fullscreenexit":E(o.fullscreen_exit);break;case"ad-skipped":!function(){if(f)switch(f){case"midroll":E(o.ad_skipped_midroll);break;case"postroll":E(o.ad_skipped_postroll);break;default:E(o.ad_skipped_preroll)}else E(o.ad_skipped_preroll)}()}var l,r}))}function k(t){e.ga.start_on&&e.ga.start_on===t&&(E(p?o.live_start:o.video_start),i=!0)}function y(){i&&E(p?o.live_complete:o.video_complete),i=!1,v=[0,0,0],n=!0,e.ga.start_on="playing"}function E(e){var t=l.videos;if(p&&(t=l.live),e&&t)if(function(){if(window.ga&&0===u.length)for(var e in c)window.ga("create",c[e],"auto","ext"+(e+1)),u.push("ext"+(e+1))}(),u&&void 0!==window.ga&&null!==window.ga)for(var a in u)window.ga(u[a]+".send","event",t,e,m);else console.debug("ga console.send","event",t,e,m)}}return function(e,t){if("object"==typeof exports&&"undefined"!=typeof module)return t;"flowplayer"in e||(e.flowplayer={extensions:[]});var a=e.flowplayer;return"function"==typeof a?(a(t),t):(Array.isArray(a.extensions)||(a.extensions=[]),~a.extensions.indexOf(t)||a.extensions.push(t),t)}(window,(function(t,a,l){if(t.ga)return e(t,0,l)}))}));
