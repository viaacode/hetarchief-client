!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((n=n||self).flowplayer=n.flowplayer||{},n.flowplayer.cuepoints=e())}(this,(function(){"use strict";var n=[].slice;function e(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var i in e)n[i]=e[i];return n}function t(n,e,t){for(var r=function(n){return Array.isArray(n)?n.slice(0):n.split(".")}(e);r.length;){if(null==n)return t;var i=r.shift();if("string"!=typeof i)return t;n=n[i]}return null==n?t:n}var r=!!function(){var n=!1;try{var e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(n){}return n}()&&{passive:!0},i=["touchstart","touchmove"];function o(n){return n.emit=function(t,r,i){i=i||{};var o=function(n){var e=document.createEvent("Event");return e.initEvent(n,!1,!0),e}(t);return r&&e(o,{data:r||{}}),n.dispatchEvent(o),!1===i.return_self?o:n},n.on=function(e,t){return"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){return function(n){return~i.indexOf(n)}(e)?n.addEventListener(e,t,r):n.addEventListener(e,t)})),n},n.off=function(e,t){return n.removeEventListener(e,t),n},n.one=n.once=function(e,t){return n.on(e,(function r(i){n.off(e,r),t(i)}))},n}var u=Array.isArray,a="undefined"!=typeof window&&o(window),f="undefined"!=typeof document&&o(document),c=["span","a","em","p","i"],s=c.concat(["div","strong","video","img","ol","ul","li","script"]);function l(n,e,t){var r=p(document.createElement(n));if(u(e)&&(t=e,e=!1),u(t)||(t=[t]),r.append(t.filter((function(n){return n}))),"object"!=typeof e)return r;for(var i in e)i in r?r[i]=e[i]:r.setAttribute(i,e[i]);return r}function d(e){var t=e.tagName;e.__flowplayer__=1,e.find=function(n){var t=e.querySelector(n);return t?p(t):t},e.html=function(n){return e.innerHTML=n,e},e.empty=function(){return e.innerHTML="",e},e.offset=function(){var n={top:0,left:0},t=e;do{n.left+=t.offsetLeft||0,n.top+=t.offsetTop||0}while(t=t.offsetParent);return n},e.innerWidth=function(){var n=getComputedStyle(e);return e.clientWidth-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)};var r=e.insert=function(n,t){return u(t)?t.map((function(t){return e.insert(n,t)}))[0]:p(t="string"==typeof t?e.insertAdjacentHTML(n,t):e.insertAdjacentElement?e.insertAdjacentElement(n,t):e.appendChild(t))};return e.append=r.bind(e,"beforeend"),e.prepend=r.bind(e,"afterbegin"),e.css=function(n,t){if("object"==typeof n){for(var r in n)e.css(r,n[r]);return e}return void 0===t?getComputedStyle(e)[n]:(1*t&&(t+="px"),e.style[n]=t,e)},e.show=function(){return e.css({display:~c.indexOf(t)?"inline":"block"})},e.hide=function(){return e.css({display:"none"})},e.remove=function(){var n=e.parentNode;n&&n.removeChild(e)},e.attr=function(n,t){return null==t?e.getAttribute(n):(e.setAttribute(n,t),e)},e.txt=function(n){return e.textContent=n,e},e.fp=function(n){return e.addClass("fp-"+n)},e.addClass=function(n){return n.split(" ").forEach((function(n){e.hasClass(n)||(e.className+=(e.className?" ":"")+n)})),e},e.removeClass=function(n){n=n.split(" ");var t=e.className.split(" ");return e.className=t.filter((function(e){return!~n.indexOf(e)})).join(" "),e},e.toggleClass=function(n,t){return void 0===t&&(t=!e.hasClass(n)),t?e.addClass(n):e.removeClass(n)},e.findAll=function(t){return r=e.querySelectorAll(t),n.call(r);var r},e.hasClass=function(n){return~e.className.split(" ").indexOf(n)},e}function p(n){return void 0===n||function(n){return n&&n.__flowplayer__}(n)?n:d(o(n))}function v(n,e){if("string"==typeof n&&"<"==n[0])return l(n.slice(1,-1),e);if("string"!=typeof n)return p(n);var t=e instanceof HTMLElement&&e.querySelector(".fp-"+n)||document.querySelector(n);return t?p(t):void 0}v.window=a,v.document=f,v.el=l,s.forEach((function(n){v[n]=function(e,t){return"string"==typeof e&&(e={class:e}),l(n,e,t)}}));var m=window.VTTCue||window.TextTrackCue;function y(n,t,r){var i=n.startTime||n.start,o=n.endTime||n.end,u=n.text||"";try{var a=new m(i,o,u);return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];n.slice(1).reduce((function(n,t){return e(n,t)}),n[0]||{})}(a,{id:t.toString()},n),a.onenter=r.emit.bind(r,"cuepointstart",{cuepoint:n}),a.onexit=r.emit.bind(r,"cuepointend",{cuepoint:n}),a}catch(n){if(i===o)return console.warn("Cue(:error)> startTime cannot equal endTime on this platform");throw n}}function h(n,e){n.cues&&n.cues.length&&[].slice.call(n.cues).forEach(e)}return function(n,e){if("object"==typeof exports&&"undefined"!=typeof module)return e;"flowplayer"in n||(n.flowplayer={extensions:[]});var t=n.flowplayer;return"function"==typeof t?(t(e),e):(Array.isArray(t.extensions)||(t.extensions=[]),~t.extensions.indexOf(e)||t.extensions.push(e),e)}(window,(function(n,e,r){var i=r.addTextTrack("metadata","fp-cuepoints");r.reaper.put("cuepoints",[]),r.on("config",(function(e){t(e,"data.cuepoints",[])!==r.cuepoints&&r.emit("cuepoints",{cuepoints:n.cuepoints})})),r.on(["cuepoints:redraw","durationchange"],(function(){n.draw_cuepoints&&e.timeline&&function(n,e,t){if(n){var r=e.duration;if(isFinite(r))n.findAll(".fp-cuepoint").forEach((function(n){n.remove()})),h(t,(function(e,t){var i=Math.round(e.startTime/r*1e3)/10,o=v.span("fp-cuepoint");if(i>100||i<0)return console.warn("Cuepoint("+t+") does not have a valid startTime("+e.startTime+") ");o.css("left",i+"%");var u=(e.endTime-e.startTime)/r*100;o.css("width",u+"%"),n.append(o)}))}}(e.timeline,r,i)})),r.on("cuepoints",(function(n){var e=t(n,"data.cuepoints",[]);r.reaper.put("cuepoints",e),h(i,(function(n){n&&i.removeCue(n)})),e.map((function(n,e){return y(n,"cuepoint-"+e,r)})).forEach((function(n){i.addCue(n)})),r.emit("cuepoints:redraw")}))}))}));
